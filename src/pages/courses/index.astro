---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import Hero from '../../components/Hero.astro';
import Card from '../../components/Card.astro';
import { getCollection } from 'astro:content';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';

const courses = await getCollection('courses');
courses.sort((a, b) => (a.data.lesson || 999) - (b.data.lesson || 999));

// Collect unique tags
const allTags = Array.from(new Set(courses.flatMap(course => course.data.tags || [])));
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<BaseHead title={`${SITE_TITLE} - Courses`} description="Learn Django, SaaS, and more with our comprehensive courses." />
		<style>
			ul {
				list-style-type: none;
				padding: unset;
			}
			ul li {
				display: flex;
			}
			ul li :global(time) {
				flex: 0 0 130px;
				font-style: italic;
				color: #595959;
			}
			ul li a:visited {
				color: #8e32dc;
			}
		</style>
	</head>
	<body class="min-h-screen font-sans text-white bg-base-100">
		<Header />
		<main class="flex flex-col items-center justify-center">
			<Hero />
			<section class="text-center mb-8 py-12">
				<h1 class="text-4xl font-bold text-primary mb-4">Courses</h1>
				<p class="text-lg text-base-content">Learn Django, SaaS, and more with our comprehensive courses.</p>
			</section>
		</main>
		<Footer />
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const filterButtons = document.querySelectorAll('[data-filter]');
				const courseItems = document.querySelectorAll('.course-item');

				filterButtons.forEach(button => {
					button.addEventListener('click', () => {
						const filter = button.getAttribute('data-filter') || '';
						courseItems.forEach(item => {
							const tags = (item as HTMLElement).getAttribute('data-tags')?.split(',') || [];
							if (filter === 'all' || tags.includes(filter)) {
								(item as HTMLElement).style.display = 'block';
							} else {
								(item as HTMLElement).style.display = 'none';
							}
						});
						// Update active button
						filterButtons.forEach(btn => (btn as HTMLElement).classList.remove('btn-active'));
						(button as HTMLElement).classList.add('btn-active');
					});
				});
			});
		</script>
	</body>
</html>